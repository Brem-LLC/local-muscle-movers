---
import { createReader } from '@keystatic/core/reader'
import keystaticConfig from 'keystatic.config'
import Layout from '@layouts/Base.astro'
import Header from '@components/Header.astro'
import Footer from '@components/Footer.astro'
import ShortHero from '@components/ShortHero.astro'
import Story from '@components/Aboutpage/Story.astro'
import Mission from '@components/Aboutpage/Mission.astro'
import WhyLMM from '@components/Aboutpage/WhyLMM.astro'
import NedQuote from '@components/Aboutpage/NedQuote.astro'

const reader = createReader(process.cwd(), keystaticConfig);
const aboutData = await reader.collections.pages.read('about');
const shortHeroBlock = aboutData?.componentBlocks.filter(bl => bl.discriminant === 'shortHero')
const storyBlock = aboutData?.componentBlocks.filter(bl => bl.discriminant === 'videoText')
const headerAndTextBlocks = aboutData?.componentBlocks.filter(bl => bl.discriminant === 'headerText')
const quoteBlock = aboutData?.componentBlocks.filter(bl => bl.discriminant === 'testimonialCTA')
---

<Layout title="About">
	<Header />
	<ShortHero block={shortHeroBlock[0].value} />
	<Story block={storyBlock[0].value} />
	<Mission block={headerAndTextBlocks[0].value} />
	<WhyLMM block={headerAndTextBlocks[1].value} />
	<NedQuote block={quoteBlock[0].value} />
	<Footer />
</Layout>
