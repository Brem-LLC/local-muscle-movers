---
import Layout from '@layouts/Base.astro'
import Hero from '@components/Hero.astro'
import WhoAreWe from '@components/WhoAreWe.astro';
import Mission from '@components/Mission.astro';
import Services from '@components/Services.astro';
import NedQuote from '@components/NedQuote.astro';
import CallToAction from '@components/CallToAction.astro';
import { createReader } from '@keystatic/core/reader';
import keystaticConfig from '../../keystatic.config';
const reader = createReader(process.cwd(), keystaticConfig);
const homeData = await reader.collections.pages.read('home');
const heroData = homeData?.componentBlocks.filter(block => block.discriminant == 'banner');
const whoAreWe = homeData?.componentBlocks.filter(block => block.discriminant == 'headerTextAndImage' && block.value.sectionType == 'whoAreWe');
const ourMission = homeData?.componentBlocks.filter(block => block.discriminant == 'headerTextAndImage' && block.value.sectionType == 'ourMission');
const ourServices = homeData?.componentBlocks.filter(block => block.discriminant == 'serviceSelector');
const callToAction = homeData?.componentBlocks.filter(block => block.discriminant == 'callToAction');
const quoteBlock = homeData?.componentBlocks.filter((bl) => bl.discriminant === 'testimonialCTA')
---

<Layout title="Home">
	{heroData && heroData[0] && <Hero heroData={heroData[0].value} />}
	{ourServices && ourServices[0] && <Services block={ourServices[0].value} />}
	{quoteBlock && quoteBlock[0] && <NedQuote block={quoteBlock[0].value} />}
	{whoAreWe && whoAreWe[0] && <WhoAreWe block={whoAreWe[0].value} />}
	{ourMission && ourMission[0] && <Mission block={ourMission[0].value} />}
	{callToAction && callToAction[0] && <CallToAction block={callToAction[0].value} />}
</Layout>